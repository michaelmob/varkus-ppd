{% extends 'base.html' %}
{% load static %}
{% load currency %}
{% load announcements %}

{% block headstylebase %}
<link rel="stylesheet" type="text/css" href="{% static 'css/base-panel.css' %}" />
{% endblock %}

{% block headjsbase %}
<script>var wsUrl="{% websocket_url %}/cp/";var hour={% now "H" %};</script>
<script src="{% static 'js/api.js' %}"></script>
<script src="{% static 'js/socket.js' %}"></script>
<script src="{% static 'js/options.js' %}"></script>
<script src="{% static 'js/apps/cp/app.js' %}"></script>
{% endblock %}

{% block aside %}{% endblock %}

{% block nav %}
<nav class="ui sticky main menu">
	<a class="hamburger icon item mobile tablet only">
		<i class="content icon"></i>
	</a>

	<div class="item">
		{% block breadcrumbs %}
			<div class="ui breadcrumb">
				<div class="section">Control Panel</div>
				<i class="right chevron icon divider"></i>
				<a href="{% url 'dashboard' %}" class="active section">Dashboard</a>
			</div>
		{% endblock %}
	</div>

	<div class="right menu tablet computer only">
		{% if user.is_authenticated %}

			{# Earnings #}
			<a class="item computer only default">
				<small>Today:&nbsp;</small>
				<small class="ui primary text">
					$<span class="user earnings today">{{ user.earnings.today|currency }}</span>
				</small>
			</a>

			<a class="item computer only">
				<small>Month:&nbsp;</small>
				<small class="ui primary text">
					$<span class="user earnings month">{{ user.earnings.month|currency }}</span>
				</small>
			</a>

			<a class="icon item hover" href="{% url 'dashboard' %}" data-content="Dashboard" data-variation="inverted">
				<i class="dashboard icon link"></i>
			</a>

			{% include 'cp/dashboard/notifications.html' %}

			<div class="ui dropdown wide icon item hover" data-content="Settings" data-variation="inverted">
				<i class="setting icon link"></i>
				<div class="menu">
					<div class="item disabled">
						{{ user.username|title }}'s Account
					</div>
					<div class="ui options item">
						<i class="options icon"></i>
						Options
					</div>
					<a class="item" href="{% url 'logout' %}">
						<i class="sign out icon"></i>
						Logout
					</a>
				</div>
			</div>

		{% else %}
			<a class="item" href="{% url 'contact' %}">
				<i class="chat icon"></i>
				<small>Contact</small>
			</a>

			<a class="item" href="{% url 'signup' %}">
				<i class="signup icon"></i>
				<small>Sign up</small>
			</a>

			<a class="item" href="{% url 'login' %}">
				<i class="sign in icon"></i>
				<small>Log in</small>
			</a>
		{% endif %}
	</div>
</nav>
{% endblock %}

{% block wrapper %}
	{% block options-modal %}
		{% include 'cp/dashboard/options.html' %}
	{% endblock %}

	{% block broadcasts %}
		{% broadcasts as broadcasts %}
		<div class="message wrapper">
			{% for broadcast in broadcasts %}
				<div class="ui icon broadcast message" data-id="{{ broadcast.pk }}">
					{# <i class="close icon"></i> #}
					<i class="{{ broadcast.icon }} icon"></i>
					<div class="content">
						<div class="header">{{ broadcast.subject }}</div>
						<p>{{ broadcast.message }}</p>
					</div>
				</div>
			{% endfor %}
		</div>
	{% endblock %}

	{% block messages %}
		{% if messages %}
			<div class="message wrapper">
				{% for message in messages %}
					<div class="ui message {% if message.tags %}{{ message.tags }}{% endif %}">
						<i class="close icon"></i>
						{{ message }}
					</div>
				{% endfor %}
			</div>
		{% endif %}
	{% endblock %}

	{% block content %}

	{% endblock %}
{% endblock %}

{% block sidemenu %} default{% endblock %}

{% block footer %}{% endblock %}
